{
  "info": {
    "_postman_id": "347776b8-eb8f-4b97-b456-611955dabf55",
    "name": "Lisa",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "_exporter_id": "34842692"
  },
  "item": [
    {
      "name": "ReadOnly Test",
      "item": [
        {
          "name": "Superuser",
          "item": [
            {
              "name": "Auth",
              "item": [
                {
                  "name": "Authorization",
                  "event": [
                    {
                      "listen": "test",
                      "script": {
                        "exec": [
                          "// Fixed TypeError by adding null check for jsonData.Authorization\r",
                          "const responseSchema = {\r",
                          "    \"data\": {\r",
                          "        \"Authorization\": {\r",
                          "            \"permissions\": \"\",\r",
                          "            \"systemId\": \"\",\r",
                          "            \"token\": \"\",\r",
                          "            \"userId\": \"7730a2a9-3c5d-4df6-a453-f9ce329c701e\",\r",
                          "            \"username\": \"su\"\r",
                          "        }\r",
                          "    }\r",
                          "}\r",
                          "\r",
                          "pm.environment.set(\"access_token\", \"\");\r",
                          "\r",
                          "pm.test('Query is successful', function () {\r",
                          "    pm.response.to.be.ok;\r",
                          "});\r",
                          "\r",
                          "const jsonData = pm.response.json().data;\r",
                          "\r",
                          "// Comparing the entire response with the expected schema\r",
                          "pm.test(\"Response matches expected schema\", () => {\r",
                          "        pm.expect(jsonData.Authorization.permissions).to.eql(responseSchema.data.Authorization.permissions);\r",
                          "        pm.expect(jsonData.Authorization.systemId).to.eql(responseSchema.data.Authorization.systemId);\r",
                          "        pm.expect(jsonData.Authorization.userId).to.not.be.empty;\r",
                          "        pm.expect(jsonData.Authorization.username).to.eql(responseSchema.data.Authorization.username);\r",
                          "        pm.expect(jsonData.Authorization.token).to.not.be.empty;\r",
                          "        pm.environment.set(\"access_token\", jsonData.Authorization.token);\r",
                          "        pm.environment.set(\"user_id\", jsonData.Authorization.userId);\r",
                          "});\r",
                          ""
                        ],
                        "type": "text/javascript",
                        "packages": {},
                        "requests": {}
                      }
                    }
                  ],
                  "request": {
                    "auth": {
                      "type": "noauth"
                    },
                    "method": "POST",
                    "header": [],
                    "body": {
                      "mode": "graphql",
                      "graphql": {
                        "query": "query Authorization {Authorization(input: {login: \"su\", password: \"1\", productId: \"Lisa\"}) {}}",
                        "variables": ""
                      }
                    },
                    "url": {
                      "raw": "http://localhost:7776/Lisa/graphql",
                      "protocol": "http",
                      "host": [
                        "localhost"
                      ],
                      "port": "7776",
                      "path": [
                        "Lisa",
                        "graphql"
                      ]
                    }
                  },
                  "response": []
                },
                {
                  "name": "GetProfile (su)",
                  "event": [
                    {
                      "listen": "test",
                      "script": {
                        "exec": [
                          "const user_id = pm.environment.get(\"user_id\");\r",
                          "\r",
                          "// Создаём схему с этим значением\r",
                          "const responseSchema = {\r",
                          "    \"data\": {\r",
                          "        \"GetProfile\": {\r",
                          "            \"id\": user_id,\r",
                          "            \"systemId\": \"\",\r",
                          "            \"username\": \"su\",\r",
                          "            \"name\": \"superuser\",\r",
                          "            \"email\": \"su@mail.ru\",\r",
                          "            \"roles\": [],\r",
                          "            \"groups\": [],\r",
                          "            \"permissions\": []\r",
                          "        }\r",
                          "    }\r",
                          "};\r",
                          "\r",
                          "pm.test('Query is successful', function () {\r",
                          "    pm.response.to.be.ok;\r",
                          "});\r",
                          "\r",
                          "// Сравнение всего ответа с ожидаемой схемой\r",
                          "pm.test(\"Response matches expected schema\", () => {\r",
                          "    pm.expect(pm.response.json()).to.eql(responseSchema);\r",
                          "});\r",
                          ""
                        ],
                        "type": "text/javascript",
                        "packages": {}
                      }
                    }
                  ],
                  "request": {
                    "auth": {
                      "type": "noauth"
                    },
                    "method": "POST",
                    "header": [],
                    "body": {
                      "mode": "graphql",
                      "graphql": {
                        "query": "query GetProfile {GetProfile(input: {id: \"{{user_id}}\", productId: \"Lisa\"}) {}}",
                        "variables": ""
                      }
                    },
                    "url": {
                      "raw": "http://localhost:7776/Lisa/graphql",
                      "protocol": "http",
                      "host": [
                        "localhost"
                      ],
                      "port": "7776",
                      "path": [
                        "Lisa",
                        "graphql"
                      ]
                    }
                  },
                  "response": []
                }
              ]
            },
            {
              "name": "App",
              "item": [
                {
                  "name": "PagesData",
                  "event": [
                    {
                      "listen": "test",
                      "script": {
                        "exec": [
                          "// Ожидаемая схема ответа\r",
                          "const responseSchema = {\r",
                          "    \"data\": {\r",
                          "        \"PagesData\": [\r",
                          "            {\r",
                          "                \"id\": \"Workspace\",\r",
                          "                \"name\": \"Workspace\",\r",
                          "                \"description\": \"\",\r",
                          "                \"isEnabled\": false,\r",
                          "                \"visible\": true,\r",
                          "                \"icon\": \"Icons/Dashboard\",\r",
                          "                \"status\": \"\",\r",
                          "                \"priority\": 100,\r",
                          "                \"alignment\": 32,\r",
                          "                \"isToggled\": false,\r",
                          "                \"source\": \"qrc:/qml/imtdocgui/SingleDocumentWorkspacePageView.qml\",\r",
                          "                \"startItem\": \"qrc:/qml/Lisa/WorkspacePage.qml\"\r",
                          "            },\r",
                          "            {\r",
                          "                \"id\": \"Devices\",\r",
                          "                \"name\": \"Hardware\",\r",
                          "                \"description\": \"\",\r",
                          "                \"isEnabled\": false,\r",
                          "                \"visible\": true,\r",
                          "                \"icon\": \"Icons/Sensor\",\r",
                          "                \"status\": \"\",\r",
                          "                \"priority\": 0,\r",
                          "                \"alignment\": 32,\r",
                          "                \"isToggled\": false,\r",
                          "                \"source\": \"qrc:/qml/imtcolgui/CollectionWorkspacePageView.qml\",\r",
                          "                \"startItem\": \"qrc:/qml/Lisa/DeviceCollectionView.qml\"\r",
                          "            },\r",
                          "            {\r",
                          "                \"id\": \"SoftwareProducts\",\r",
                          "                \"name\": \"Software\",\r",
                          "                \"description\": \"\",\r",
                          "                \"isEnabled\": false,\r",
                          "                \"visible\": true,\r",
                          "                \"icon\": \"Icons/Key\",\r",
                          "                \"status\": \"\",\r",
                          "                \"priority\": 0,\r",
                          "                \"alignment\": 32,\r",
                          "                \"isToggled\": false,\r",
                          "                \"source\": \"qrc:/qml/imtcolgui/CollectionWorkspacePageView.qml\",\r",
                          "                \"startItem\": \"qrc:/qml/Lisa/SoftwareProductCollectionView.qml\"\r",
                          "            },\r",
                          "            {\r",
                          "                \"id\": \"Orders\",\r",
                          "                \"name\": \"Orders\",\r",
                          "                \"description\": \"\",\r",
                          "                \"isEnabled\": false,\r",
                          "                \"visible\": true,\r",
                          "                \"icon\": \"Icons/Deployment\",\r",
                          "                \"status\": \"\",\r",
                          "                \"priority\": 0,\r",
                          "                \"alignment\": 32,\r",
                          "                \"isToggled\": false,\r",
                          "                \"source\": \"qrc:/qml/imtcolgui/CollectionWorkspacePageView.qml\",\r",
                          "                \"startItem\": \"qrc:/qml/Lisa/OrderCollectionView.qml\"\r",
                          "            },\r",
                          "            {\r",
                          "                \"id\": \"Accounts\",\r",
                          "                \"name\": \"Customers\",\r",
                          "                \"description\": \"\",\r",
                          "                \"isEnabled\": false,\r",
                          "                \"visible\": true,\r",
                          "                \"icon\": \"Icons/Customer\",\r",
                          "                \"status\": \"\",\r",
                          "                \"priority\": 0,\r",
                          "                \"alignment\": 32,\r",
                          "                \"isToggled\": false,\r",
                          "                \"source\": \"qrc:/qml/imtcolgui/CollectionWorkspacePageView.qml\",\r",
                          "                \"startItem\": \"qrc:/qml/Lisa/AccountCollectionView.qml\"\r",
                          "            },\r",
                          "            {\r",
                          "                \"id\": \"Search\",\r",
                          "                \"name\": \"Search\",\r",
                          "                \"description\": \"\",\r",
                          "                \"isEnabled\": false,\r",
                          "                \"visible\": true,\r",
                          "                \"icon\": \"Icons/Search\",\r",
                          "                \"status\": \"\",\r",
                          "                \"priority\": 0,\r",
                          "                \"alignment\": 64,\r",
                          "                \"isToggled\": false,\r",
                          "                \"source\": \"qrc:/qml/imtdocgui/SearchPageSingleDocumentView.qml\",\r",
                          "                \"startItem\": \"qrc:/qml/imtgui/View/SearchPage.qml\"\r",
                          "            },\r",
                          "            {\r",
                          "                \"id\": \"Administration\",\r",
                          "                \"name\": \"Admin\",\r",
                          "                \"description\": \"\",\r",
                          "                \"isEnabled\": false,\r",
                          "                \"visible\": true,\r",
                          "                \"icon\": \"Icons/AdminPanel\",\r",
                          "                \"status\": \"\",\r",
                          "                \"priority\": 0,\r",
                          "                \"alignment\": 64,\r",
                          "                \"isToggled\": false,\r",
                          "                \"source\": \"qrc:/qml/imtdocgui/SingleDocumentWorkspacePageView.qml\",\r",
                          "                \"startItem\": \"qrc:/qml/imtauthgui/AdministrationView.qml\"\r",
                          "            }\r",
                          "        ]\r",
                          "    }\r",
                          "}\r",
                          "\r",
                          "pm.test('Query is successful', function () {\r",
                          "    pm.response.to.be.ok;\r",
                          "});\r",
                          "\r",
                          "// Сравнение всего ответа с ожидаемой схемой\r",
                          "pm.test(\"Response matches expected schema\", () => {\r",
                          "    pm.expect(pm.response.json()).to.eql(responseSchema);\r",
                          "});"
                        ],
                        "type": "text/javascript",
                        "packages": {},
                        "requests": {}
                      }
                    }
                  ],
                  "request": {
                    "auth": {
                      "type": "apikey",
                      "apikey": [
                        {
                          "key": "value",
                          "value": "{{access_token}}",
                          "type": "string"
                        },
                        {
                          "key": "key",
                          "value": "x-authentication-token",
                          "type": "string"
                        },
                        {
                          "key": "in",
                          "value": "header",
                          "type": "string"
                        }
                      ]
                    },
                    "method": "POST",
                    "header": [],
                    "body": {
                      "mode": "graphql",
                      "graphql": {
                        "query": "query PagesData {PagesData {items {PageId name Icon Source StartItem}}}",
                        "variables": ""
                      }
                    },
                    "url": {
                      "raw": "http://localhost:7776/Lisa/graphql",
                      "protocol": "http",
                      "host": [
                        "localhost"
                      ],
                      "port": "7776",
                      "path": [
                        "Lisa",
                        "graphql"
                      ]
                    }
                  },
                  "response": []
                }
              ]
            }
          ]
        }
      ]
    }
  ]
}